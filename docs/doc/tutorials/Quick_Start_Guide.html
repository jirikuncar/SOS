<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />
<title>Quick_Start_Guide</title><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>








<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>

 <link rel="stylesheet" href="http://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>

<style>  /* defined here in case the main.css below cannot be loaded */
.lev1 {margin-left: 80px}
.lev2 {margin-left: 100px}
.lev3 {margin-left: 120px}
.lev4 {margin-left: 140px}
.lev5 {margin-left: 160px}
.lev6 {margin-left: 180px}
</style>

<link rel="stylesheet" type="text/css" href="../../css/jt.css">
<link rel="stylesheet" type="text/css" href="../../css/toc2.css">

<script src="https://rawgit.com/ipython-contrib/jupyter_contrib_nbextensions/master/src/jupyter_contrib_nbextensions/nbextensions/toc2/toc2.js"></script>

 <script src="../../js/docs.js"></script>

<script>
    MathJax.Hub.Config({
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["STIX","TeX"],
            styles: {
                scale: 110,
                ".MathJax_Display": {
                    "font-size": "110%",
                }
            }
        }
    });
</script>

<script>
$( document ).ready(function(){

            var cfg={'threshold':4,     // depth of toc (number of levels)
             // 'number_sections': true,  
             'number_sections': false,  // sections numbering
             'toc_cell': false,          // useless here
             'toc_window_display': true, // display the toc window
             "toc_section_display": "block", // display toc contents in the window
             // 'sideBar':true,      
             'sideBar':true,       // sidebar or floating window
             'navigate_menu':false       // navigation menu (only in liveNotebook -- do not change)
            }

            var st={};                  // some variables used in the script
            st.rendering_toc_cell = false;
            st.config_loaded = false;
            st.extension_initialized=false;
            st.nbcontainer_marginleft = $('#notebook-container').css('margin-left')
            st.nbcontainer_marginright = $('#notebook-container').css('margin-right')
            st.nbcontainer_width = $('#notebook-container').css('width')
            st.oldTocHeight = undefined
            st.cell_toc = undefined;
            st.toc_index=0;

            // fire the main function with these parameters


            table_of_contents(cfg,st);


            var file=tutorialsDict[$("h1:first").attr("id")];
            var path="http://vatlab.github.io/SOS"
            // var path="file:///Users/jma7/Development/SOS/docs"
            $("#toc-level0 a").css("color","#126dce");
            $('a[href="#'+$("h1:first").attr("id")+'"]').hide()
            
            var tuts=tutorials;
            var pos=tutorials.indexOf(file);
        
            for (var a=pos;a>=0;a--){
                  var name=tuts[a]
                  $('<li><a href="'+path+'/doc/tutorials/'+name+'.html">'+name.replace(/_/g," ")+'</a></li>').insertBefore("#toc-level0 li:eq(0)");
            }
            $('a[href="'+path+'/doc/tutorials/'+file+'.html'+'"]').css("color","#126dce");

            $('<li id="indexHome" style="margin-bottom:10pt"> <a href="http://vatlab.github.io/SOS/index.html#documentation"> <img height="32" width="32" style="border:0px;margin-right:5px;vertical-align:bottom" src="http://vatlab.github.io/SOS/img/sos_icon.svg"> <b>Script of Scripts<b></b></a> </li>').insertBefore("#toc-level0 li:eq(0)");
            for (var a=pos+1;a<tuts.length;a++){
                  var name=tuts[a]
                  $(".toc #toc-level0").append('<li><a href="'+path+'/doc/tutorials/'+name+'.html">'+name.replace(/_/g," ")+'</a></li>');
            }
            $("#toc-header").hide();
            $("#toc").attr("style","max-height:938px")


            // for (var a =0;a<tuts.length;a++){
            //       var name =tuts[a];
            //       if ()
            //       $(".toc #toc-level0").append('<li><a href="'+path+'/doc/tutorials/'+name+'.html">'+name.replace("_"," ")+'</a></li>');
            // }

            // $(".toc #toc-level0").append('<li id="indexHome"><a href="'+path+'/index.html"><b>Home<b></a></li>');
            // var home=$("#toc-level0 #indexHome");
          
            // home.insertBefore("#toc-level0 li:eq(0)");

            
            // $(".number_sections-btn").hide();
            // $(".toc_cell_sections-btn".hide();


    });
</script><style>  /* defined here in case the main.css below cannot be loaded */

 .lan_sos {}.lan_ir {background-color: #FDEDEC !important }.lan_python3 {background-color: #EAFAF1 !important }.lan_bash {background-color: #E6EEFF !important }

</style>
<body>
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Quick-Start-Guide">Quick Start Guide<a class="anchor-link" href="#Quick-Start-Guide">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before we start our tutorial, it is important to understand a SoS script can be executed from command line in batch mode, or interactively in Jupyter notebook. This tutorial is written in Jupyter but you can execute the scripts in batch mode if you save them to disk and execute them using command <code>sos run</code> or <code>sos-runner</code>. There are some minor differences in executing scripts in these modes so the following cell turns on more output (<code>-v2</code>), change default signature mode to <code>default</code> (<code>-s default</code>), and turn off automatic output preview (<code>%preview --off</code>). It then creates some empty files as input files of the sample workflows and remove existing runtime signatures by executing some shell commands (<code>!cmd</code>). Please refer to <a href="../documentation/Notebook_Interface.html">Chapter Notebook Interface</a> of the SoS documentation if you would like to learn more about them.</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_sos">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="o">%</span><span class="nb">set</span> <span class="o">-</span><span class="n">v2</span> <span class="o">-</span><span class="n">s</span> <span class="n">default</span>
<span class="o">%</span><span class="n">preview</span> <span class="o">--</span><span class="n">off</span>
<span class="err">!</span><span class="n">touch</span> <span class="n">mutated</span><span class="o">.</span><span class="n">fastq</span> <span class="n">control</span><span class="o">.</span><span class="n">fastq</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">fastq</span> <span class="n">case</span><span class="o">.</span><span class="n">fastq</span>
<span class="err">!</span><span class="n">cp</span> <span class="n">STAR</span> <span class="n">Rscript</span> <span class="o">~/.</span><span class="n">sos</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span>
<span class="err">!</span><span class="n">sos</span> <span class="n">remove</span> <span class="o">--</span><span class="n">signature</span> <span class="o">-</span><span class="n">v</span> <span class="mi">0</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Set sos options to &#34;-v2 -s default&#34;
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Multi-Language-Notebook">Multi-Language Notebook<a class="anchor-link" href="#Multi-Language-Notebook">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us assume that you are a bioinformaticist needed to compare the expression levels between two samples. You can use a Jupyter notebook with SoS kernel to perform the analysis using different script, the trick here is to select the right kernel for each cell. For example, you can run the following cell in bash if you choose <code>bash</code> as the kernel.</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_bash">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1"># index reference genome</span>
<span class="n">STAR</span> <span class="o">--</span><span class="n">runMode</span> <span class="n">genomeGenerate</span> <span class="o">--</span><span class="n">genomeFastaFile</span> <span class="n">human38</span><span class="o">.</span><span class="n">fastq</span> \
    <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span>
<span class="c1"># align reads to the reference genome</span>
<span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
    <span class="o">--</span><span class="n">readFilesIn</span> <span class="n">control</span><span class="o">.</span><span class="n">fastq</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
    <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="n">control</span>
<span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
    <span class="o">--</span><span class="n">readFilesIn</span> <span class="n">mutated</span><span class="o">.</span><span class="n">fastq</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
    <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="n">mutated</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating STAR_index/chrName.txt
Generating aligned/control.out.tab from control.fastq
Generating aligned/mutated.out.tab from mutated.fastq
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first command builds an index of the reference genome in preparation for the latter steps, the second command aligns reads from the first sample to the reference genome, and the third command aligns reads from the second sample to the reference genome. Do not panic if you do not know what these commands are doing, this is just an example.</p>
<p>These commands generate, among other files, two files named <code>aligned/control.out.tab</code> and <code>aligned/mutated.out.tab</code> with expression counts of all genes. You then wrote a <a href="https://www.r-project.org/">R</a> script to analyze the results, something like</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_ir">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">control</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;aligned/control.out.tab&#39;</span><span class="p">)</span>
<span class="n">mutated</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;aligned/mutated.out.tab&#39;</span><span class="p">)</span>
<span class="c1"># normalize, compare, output etc, ignored.</span>
<span class="n">pdf</span><span class="p">(</span><span class="s1">&#39;myfigure.pdf&#39;</span><span class="p">)</span>
<span class="c1"># plot results</span>
<span class="n">dev</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>

<div class="output_html rendered_html output_subarea ">
<strong>pdf:</strong> 2
</div>

</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="String-Interpolation">String Interpolation<a class="anchor-link" href="#String-Interpolation">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is nice to run scripts in different langauges and record results in a notebook script, but the above example is not much different from running two separate scripts from command line. Because different steps of data analysis are naturally connected, it would be good to share information among them. This can be achived by passing (Python) variables defined in the SoS kernel to the subkernels.</p>
<p>For example, if we define the directory for <code>STAR</code> index and align output,</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_sos">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">INDEXDIR</span> <span class="o">=</span> <span class="s1">&#39;STAR_index&#39;</span>
<span class="n">ALIGNDIR</span> <span class="o">=</span> <span class="s1">&#39;aligned&#39;</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">interactive_0</span>: 
INFO: Workflow interactive (ID=b138a0442b0e7292) is executed successfully.
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>we can pass the variable to subkernels through string interpolation, which replaces expressions enbraced by <code>${</code> and <code>}</code> with the values. For example, the shell script could be written as</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_bash">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1"># index reference genome</span>
<span class="n">STAR</span> <span class="o">--</span><span class="n">runMode</span> <span class="n">genomeGenerate</span> <span class="o">--</span><span class="n">genomeFastaFile</span> <span class="n">human38</span><span class="o">.</span><span class="n">fastq</span> \
    <span class="o">--</span><span class="n">genomeDir</span> <span class="err">$</span><span class="p">{</span><span class="n">INDEXDIR</span><span class="p">}</span>
<span class="c1"># align reads to the reference genome</span>
<span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
    <span class="o">--</span><span class="n">readFilesIn</span> <span class="n">control</span><span class="o">.</span><span class="n">fastq</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
    <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="err">$</span><span class="p">{</span><span class="n">ALIGNDIR</span><span class="p">}</span><span class="o">/</span><span class="n">control</span>
<span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
    <span class="o">--</span><span class="n">readFilesIn</span> <span class="n">mutated</span><span class="o">.</span><span class="n">fastq</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
    <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="err">$</span><span class="p">{</span><span class="n">ALIGNDIR</span><span class="p">}</span><span class="o">/</span><span class="n">mutated</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>STAR --runMode genomeGenerate --genomeFastaFile human38.fastq \
    --genomeDir STAR_index
# align reads to the reference genome
STAR --genomeDir STAR_index --outSAMtype BAM SortedByCoordinate \
    --readFilesIn control.fastq --quantMode GeneCounts \
    --outFileNamePrefix aligned/control
STAR --genomeDir STAR_index --outSAMtype BAM SortedByCoordinate \
    --readFilesIn mutated.fastq --quantMode GeneCounts \
    --outFileNamePrefix aligned/mutated
## -- End interpolated command --
Generating STAR_index/chrName.txt
Generating aligned/control.out.tab from control.fastq
Generating aligned/mutated.out.tab from mutated.fastq
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>where expressions such as <code>${align_dir}</code> are replaced with their values before the script is interpreted by bash. Similarly, the R script could make use of varialbe <code>align_dir</code>.</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_ir">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">control</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;${ALIGNDIR}/control.out.tab&#39;</span><span class="p">)</span>
<span class="n">mutated</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;${ALIGNDIR}/mutated.out.tab&#39;</span><span class="p">)</span>
<span class="c1"># normalize, compare, output etc, ignored.</span>
<span class="n">pdf</span><span class="p">(</span><span class="s1">&#39;myfigure.pdf&#39;</span><span class="p">)</span>
<span class="c1"># plot results</span>
<span class="n">dev</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>control.count &lt;- read.table(&#39;aligned/control.out.tab&#39;)
mutated.count &lt;- read.table(&#39;aligned/mutated.out.tab&#39;)
# normalize, compare, output etc, ignored.
pdf(&#39;myfigure.pdf&#39;)
# plot results
dev.off()
## -- End interpolated command --
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>

<div class="output_html rendered_html output_subarea ">
<strong>pdf:</strong> 2
</div>

</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>SoS accepts and expands <a href="https://docs.python.org/3.5/library/string.html#formatspec">python format specification and conversion operators</a> and allows you convert and format the result of expressions. Please refer to <a href="../documentation/String_Interpolation.html">chapter String Interpolation</a> for details.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Exchange-among-subkernels">Data Exchange among subkernels<a class="anchor-link" href="#Data-Exchange-among-subkernels">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>String interpolation is useful for composing scripts to be executed by subkernels, but it would be awkward to pass a large amount of information in this way, and it disallows passing information among subkernels.</p>
<p>SoS provides a few <code>magics</code> to faciliate data exchange among subkernels. For example, the <code>%get</code> magic retrieves information from the SoS kernel to a subkernel, so your shell script could be written as:</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_bash">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="o">%</span><span class="n">get</span> <span class="n">INDEXDIR</span> <span class="n">ALIGNDIR</span>
<span class="c1"># index reference genome</span>
<span class="n">STAR</span> <span class="o">--</span><span class="n">runMode</span> <span class="n">genomeGenerate</span> <span class="o">--</span><span class="n">genomeFastaFile</span> <span class="n">human38</span><span class="o">.</span><span class="n">fastq</span> \
    <span class="o">--</span><span class="n">genomeDir</span> <span class="err">$</span><span class="n">INDEXDIR</span>
<span class="c1"># align reads to the reference genome</span>
<span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
    <span class="o">--</span><span class="n">readFilesIn</span> <span class="n">control</span><span class="o">.</span><span class="n">fastq</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
    <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="err">$</span><span class="n">ALIGNDIR</span><span class="o">/</span><span class="n">control</span>
<span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
    <span class="o">--</span><span class="n">readFilesIn</span> <span class="n">mutated</span><span class="o">.</span><span class="n">fastq</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
    <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="err">$</span><span class="n">ALIGNDIR</span><span class="o">/</span><span class="n">mutated</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating STAR_index/chrName.txt
Generating aligned/control.out.tab from control.fastq
Generating aligned/mutated.out.tab from mutated.fastq
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>after retriving <code>INDEXDIR</code> and <code>ALIGNDIR</code> from the SoS kernel and create two native shell variables <code>INDEXDIR</code> and <code>ALIGNDIR</code>. Similarly, your R script could be written as</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_ir">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="o">%</span><span class="n">get</span> <span class="n">ALIGNDIR</span>
<span class="n">control</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="n">ALIGNDIR</span><span class="p">,</span> <span class="s1">&#39;/control.out.tab&#39;</span><span class="p">))</span>
<span class="n">mutated</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="n">ALIGNDIR</span><span class="p">,</span> <span class="s1">&#39;/mutated.out.tab&#39;</span><span class="p">))</span>
<span class="c1"># normalize, compare, output etc, ignored.</span>
<span class="n">pdf</span><span class="p">(</span><span class="s1">&#39;myfigure.pdf&#39;</span><span class="p">)</span>
<span class="c1"># plot results</span>
<span class="n">dev</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>

<div class="output_html rendered_html output_subarea ">
<strong>pdf:</strong> 2
</div>

</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The subkernels are persistent so the passed variables can be used in later cells using the same kernel, for example, variable <code>ALIGNDIR</code> can be used in the Bash kernel in new commands as follows:</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_bash">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">echo</span> <span class="n">Align</span> <span class="n">directory</span> <span class="ow">is</span> <span class="err">$</span><span class="n">ALIGNDIR</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Align directory is aligned
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that SoS magics and multiple live subkernels are only supported by Jupyter notebook and cannot be used in SoS batch mode.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Your-first-SoS-script">Your first SoS script<a class="anchor-link" href="#Your-first-SoS-script">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The project completed successfully and you needed to archive the scripts for later reference. The Jupyter notebook is a perfect format to record both the commands and the results. However, if you would like to only save the steps of your analysis, you can save the notebook in <code>.sos</code> format (<code>File</code>-&gt;<code>Download As</code>-&gt;<code>.sos</code>) or copy/paste the commands to a single SoS script named <code>myanalysis.sos</code>, with content</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_sos">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="ch">#!/usr/bin/env sos-runner</span>
<span class="c1">#fileformat=SOS1.0</span>

<span class="c1"># This script aligns raw reads of a control and a mutated sample</span>
<span class="c1"># to the reference genome and compare the expression values</span>
<span class="c1"># of the samples at genes A, B and C.</span>

<span class="kn">run:</span>
<span class="c1"># index reference genome</span>
<span class="n">STAR</span> <span class="o">--</span><span class="n">runMode</span> <span class="n">genomeGenerate</span> <span class="o">--</span><span class="n">genomeFastaFile</span> <span class="n">human38</span><span class="o">.</span><span class="n">fastq</span> \
    <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span>

<span class="c1"># align reads to the reference genome</span>
<span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
    <span class="o">--</span><span class="n">readFilesIn</span> <span class="n">control</span><span class="o">.</span><span class="n">fastq</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
    <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="n">control</span>
<span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
    <span class="o">--</span><span class="n">readFilesIn</span> <span class="n">mutated</span><span class="o">.</span><span class="n">fastq</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
    <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="n">mutated</span>

<span class="kn">R:</span>
<span class="n">control</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;aligned/control.out.tab&#39;</span><span class="p">)</span>
<span class="n">mutated</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;aligned/mutated.out.tab&#39;</span><span class="p">)</span>
<span class="c1"># normalize, compare, output etc, ignored.</span>
<span class="n">pdf</span><span class="p">(</span><span class="s1">&#39;myfigure.pdf&#39;</span><span class="p">)</span>
<span class="c1"># plot results</span>
<span class="n">dev</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">interactive_0</span>: 
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating STAR_index/chrName.txt
Generating aligned/control.out.tab from control.fastq
Generating aligned/mutated.out.tab from mutated.fastq
Generating myfigure.pdf
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Workflow interactive (ID=868b4f6042b50900) is executed successfully.
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here <strong><code>run</code></strong> and <strong><code>R</code></strong> are SoS actions that executes the following scripts in <code>bash</code> and <code>R</code> respectively. The scripts are included verbatim and end after reaching another SoS action or directive. For the sake of time, we created fake <code>STAR</code> and <code>R</code> commands that simply states the file generated.</p>
<p>The script is executed in Jupyter when the notebook (this documentation) is executed. In command line, you would need to run the script using command</p>

<pre><code>% sos run myscript</code></pre>
<p>or</p>

<pre><code>% myscript.sos</code></pre>
<p>if you make <code>myscript.sos</code> executable (by running <code>chmod +x myscript.sos</code>.</p>
<p>As you can see, this sos script simply executes the embedded shell and R script and generates the four output files.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although it is convenient to embed scripts verbatim, it is often clearer to indent the script and write your SoS script as:</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_sos">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="ch">#!/usr/bin/env sos-runner</span>
<span class="c1">#fileformat=SOS1.0</span>

<span class="c1"># This script aligns raw reads of a control and a mutated sample</span>
<span class="c1"># to the reference genome and compare the expression values</span>
<span class="c1"># of the samples at genes A, B and C.</span>

<span class="kn">run:</span>
    <span class="c1"># index reference genome</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">runMode</span> <span class="n">genomeGenerate</span> <span class="o">--</span><span class="n">genomeFastaFile</span> <span class="n">human38</span><span class="o">.</span><span class="n">fastq</span>\
        <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span>

    <span class="c1"># align reads to the reference genome</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
        <span class="o">--</span><span class="n">readFilesIn</span> <span class="n">control</span><span class="o">.</span><span class="n">fastq</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
        <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="n">control</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
        <span class="o">--</span><span class="n">readFilesIn</span> <span class="n">mutated</span><span class="o">.</span><span class="n">fastq</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
        <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="n">mutated</span>

<span class="c1"># compare expression values</span>
<span class="kn">R:</span>
    <span class="n">control</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;aligned/control.out.tab&#39;</span><span class="p">)</span>
    <span class="n">mutated</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;aligned/mutated.out.tab&#39;</span><span class="p">)</span>
    <span class="c1"># normalize, compare, output etc, ignored.</span>
    <span class="n">pdf</span><span class="p">(</span><span class="s1">&#39;myfigure.pdf&#39;</span><span class="p">)</span>
    <span class="c1"># plot results</span>
    <span class="n">dev</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">interactive_0</span>: 
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating STAR_index/chrName.txt
Generating aligned/control.out.tab from control.fastq
Generating aligned/mutated.out.tab from mutated.fastq
Generating myfigure.pdf
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Workflow interactive (ID=585d898c6b6548e9) is executed successfully.
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The scripts in this case end with the end of indentation so that you can add some comments for the <code>R</code> script without being considered as part of the previous script. The script works identically to the one without indentation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Separate-scripts-into-steps">Separate scripts into steps<a class="anchor-link" href="#Separate-scripts-into-steps">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Because the scripts perform different tasks, it is logically clearer to separate them into different <strong>steps</strong>. Actually, because the first reference-generating command is not a data processing step, it makes sense to separate it into two scripts. Now we can insert step headers to the script as follows:</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_sos">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="ch">#!/usr/bin/env sos-runner</span>
<span class="c1">#fileformat=SOS1.0</span>

<span class="c1"># This script aligns raw reads of a control and a mutated sample</span>
<span class="c1"># to the reference genome and compare the expression values</span>
<span class="c1"># of the samples at genes A, B and C.</span>

<span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># index reference genome</span>
<span class="kn">run:</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">runMode</span> <span class="n">genomeGenerate</span> <span class="o">--</span><span class="n">genomeFastaFile</span> <span class="n">human38</span><span class="o">.</span><span class="n">fastq</span> \
        <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span>

<span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="c1"># align reads to the reference genome</span>
<span class="kn">run:</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
        <span class="o">--</span><span class="n">readFilesIn</span> <span class="n">control</span><span class="o">.</span><span class="n">fastq</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
        <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="n">control</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
        <span class="o">--</span><span class="n">readFilesIn</span> <span class="n">mutated</span><span class="o">.</span><span class="n">fastq</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
        <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="n">mutated</span>

<span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="c1"># compare expression values</span>
<span class="kn">R:</span>
    <span class="n">control</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;aligned/control.out.tab&#39;</span><span class="p">)</span>
    <span class="n">mutated</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;aligned/mutated.out.tab&#39;</span><span class="p">)</span>
    <span class="c1"># normalize, compare, output etc, ignored.</span>
    <span class="n">pdf</span><span class="p">(</span><span class="s1">&#39;myfigure.pdf&#39;</span><span class="p">)</span>
    <span class="c1"># plot results</span>
    <span class="n">dev</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">default_1</span>: index reference genome
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating STAR_index/chrName.txt
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">default_2</span>: align reads to the reference genome
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating aligned/control.out.tab from control.fastq
Generating aligned/mutated.out.tab from mutated.fastq
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">default_3</span>: compare expression values
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating myfigure.pdf
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Workflow default (ID=160b0c267773e5bc) is executed successfully.
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, when you execute the script with command</p>

<pre><code>sos run myscript</code></pre>
<p>SoS will display <code>default_1</code>, <code>default_2</code> and <code>default_3</code> to report progress. The comments after section heads are considered step comments and will also be displayed during execution.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Make-the-script-work-for-other-input-files">Make the script work for other input files<a class="anchor-link" href="#Make-the-script-work-for-other-input-files">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After a while, before you almost forgot about this analysis, you needed to analyze another pair of samples. You could copy <code>myanalysis.sos</code> to <code>myanalysis2.sos</code>, change filenames and run it, but an easier way is to change your SoS file to accommodate other input files. This can be done by defining a command line argument and passing files name to a <strong>SoS variable</strong>:</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_sos">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="ch">#!/usr/bin/env sos-runner</span>
<span class="c1">#fileformat=SOS1.0</span>

<span class="c1"># This script aligns raw reads of a control and a mutated sample</span>
<span class="c1"># to the reference genome and compare the expression values</span>
<span class="c1"># of the samples at genes A, B and C.</span>

<span class="c1"># Two input files in .fastq formats. The first one for control sample</span>
<span class="c1"># and the second one for mutated sample.</span>
<span class="kn">parameter:</span> <span class="n">fastq_files</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;control.fastq&#39;</span><span class="p">,</span> <span class="s1">&#39;mutated.fastq&#39;</span><span class="p">]</span>

<span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># index reference genome</span>
<span class="kn">run:</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">runMode</span> <span class="n">genomeGenerate</span> <span class="o">--</span><span class="n">genomeFastaFile</span> <span class="n">human38</span><span class="o">.</span><span class="n">fastq</span> \
        <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span>

<span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="c1"># align reads to the reference genome</span>
<span class="kn">run:</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
        <span class="o">--</span><span class="n">readFilesIn</span> <span class="err">$</span><span class="p">{</span><span class="n">fastq_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
        <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="n">control</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
        <span class="o">--</span><span class="n">readFilesIn</span> <span class="err">$</span><span class="p">{</span><span class="n">fastq_files</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
        <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="n">mutated</span>

<span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="c1"># compare expression values</span>
<span class="kn">R:</span>
    <span class="n">control</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;aligned/control.out.tab&#39;</span><span class="p">)</span>
    <span class="n">mutated</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;aligned/mutated.out.tab&#39;</span><span class="p">)</span>
    <span class="c1"># normalize, compare, output etc, ignored.</span>
    <span class="n">pdf</span><span class="p">(</span><span class="s1">&#39;myfigure.pdf&#39;</span><span class="p">)</span>
    <span class="c1"># plot results</span>
    <span class="n">dev</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">default_1</span>: index reference genome
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating STAR_index/chrName.txt
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">default_2</span>: align reads to the reference genome
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating aligned/control.out.tab from control.fastq
Generating aligned/mutated.out.tab from mutated.fastq
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">default_3</span>: compare expression values
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating myfigure.pdf
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Workflow default (ID=3b5666a4bc92cb22) is executed successfully.
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A command line argument <code>fastq_files</code> is defined in with <code>parameter</code> keyword. With this definition, you can pass two filenames to variable <code>fastq_files</code> from command line</p>
<div class="highlight"><pre><span></span>sos run myanalysis --fastq_files ctrl.fastq <span class="k">case</span>.fastq
</pre></div>
<p><code>${fastq_files[0]}</code> and <code>${fastq_files[1]}</code> in command <code>STAR --genomeDir ...</code> will be replaced with their values before the commands are executed. Here <code>fastq_files[0]</code> and <code>fastq_files[1]</code> are Python expressions that will be evaluated during execution.</p>
<p>In Jupyter notebook, we can execute the previous cell with additional option using magic <code>%rerun</code>.</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_sos">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="o">%</span><span class="n">rerun</span> <span class="o">--</span><span class="n">fastq_files</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">fastq</span> <span class="n">case</span><span class="o">.</span><span class="n">fastq</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">default_1</span>: index reference genome
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating STAR_index/chrName.txt
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">default_2</span>: align reads to the reference genome
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating aligned/control.out.tab from ctrl.fastq
Generating aligned/mutated.out.tab from case.fastq
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">default_3</span>: compare expression values
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating myfigure.pdf
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Workflow default (ID=f1873112ddf76541) is executed successfully.
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Ignore-steps-that-do-not-need-to-be-rerun">Ignore steps that do not need to be rerun<a class="anchor-link" href="#Ignore-steps-that-do-not-need-to-be-rerun">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although the SoS script now accepts command line arguments, it is still no more than a compilation of scripts and you immediately realized that it is a waste of time to execute the first command each time. To solve this problem, you can convert the SoS script to a real workflow by telling SoS the input and output of each step:</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_sos">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="ch">#!/usr/bin/env sos-runner</span>
<span class="c1">#fileformat=SOS1.0</span>

<span class="c1"># This script aligns raw reads of a control and a mutated sample</span>
<span class="c1"># to the reference genome and compare the expression values</span>
<span class="c1"># of the samples at genes A, B and C.</span>

<span class="c1"># Two input files in .fastq formats. The first one for control sample</span>
<span class="c1"># and the second one for mutated sample.</span>
<span class="kn">parameter:</span> <span class="n">fastq_files</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;control.fastq&#39;</span><span class="p">,</span> <span class="s1">&#39;mutated.fastq&#39;</span><span class="p">]</span>

<span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># create a index for reference genome</span>
<span class="kn">output:</span> <span class="s1">&#39;STAR_index/chrName.txt&#39;</span>
<span class="kn">run:</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">runMode</span> <span class="n">genomeGenerate</span> <span class="o">--</span><span class="n">genomeFastaFile</span> <span class="n">human38</span><span class="o">.</span><span class="n">fastq</span> \
        <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span>

<span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="c1"># align the reads to the reference genome</span>
<span class="kn">input:</span>    <span class="n">fastq_files</span>
<span class="kn">depends:</span>  <span class="s1">&#39;STAR_index/chrName.txt&#39;</span>
<span class="kn">output:</span>   <span class="p">[</span><span class="s1">&#39;aligned/control.out.tab&#39;</span><span class="p">,</span> <span class="s1">&#39;aligned/mutated.out.tab&#39;</span><span class="p">]</span>
<span class="kn">run:</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
        <span class="o">--</span><span class="n">readFilesIn</span> <span class="err">$</span><span class="p">{</span><span class="nb">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
        <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="n">control</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
        <span class="o">--</span><span class="n">readFilesIn</span> <span class="err">$</span><span class="p">{</span><span class="nb">input</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
        <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="n">mutated</span>

<span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="c1"># compare expression values</span>
<span class="kn">output:</span> <span class="s1">&#39;myfigure.pdf&#39;</span>
<span class="kn">R:</span>
    <span class="n">control</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;${input[0]}&#39;</span><span class="p">)</span>
    <span class="n">mutated</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;${input[1]}&#39;</span><span class="p">)</span>
    <span class="c1"># normalize, compare, output etc, ignored.</span>
    <span class="n">pdf</span><span class="p">(</span><span class="s1">&#39;${output}&#39;</span><span class="p">)</span>
    <span class="c1"># plot results</span>
    <span class="n">dev</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">default_1</span>: create a index for reference genome
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating STAR_index/chrName.txt
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">default_2</span>: align the reads to the reference genome
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating aligned/control.out.tab from control.fastq
Generating aligned/mutated.out.tab from mutated.fastq
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">default_3</span>: compare expression values
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating myfigure.pdf
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Workflow default (ID=65e3d5ba2d00aaeb) is executed successfully.
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we</p>
<ul>
<li>Use <strong>output directive</strong> to specify the expected output of all steps.</li>
<li>Use <strong>input directive</strong> to specify the input of step 2. Step 1 by default has no input and input for step 3 by default is the output of step 2, its previous step.</li>
<li>Use <strong>depends directive</strong> to let step 2 depend on the output of step 1.</li>
<li>Use <code>${input[0]}</code> and <code>${input[1]}</code> in step 2 and 3 because these steps now have properly-defined <code>input</code>. This variable is defined by step input as the input file of the step.</li>
</ul>
<p>With such information, when you run the same command with another set of input file</p>
<div class="highlight"><pre><span></span>sos run myanalysis --input ctrl.fastq <span class="k">case</span>.fastq
</pre></div>
<p>SoS will ignore step 1 if this step has been run with output <code>STAR_index/chrName.txt</code>. The same happens to step 2 and 3 so all steps will be ignored if you run the script repeatedly with the same input and processing scripts. SoS uses <strong>runtime signature</strong> for each step and will re-run the step if and only if the content or filename of input, output files or the processing scripts are changed.</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_sos">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="o">%</span><span class="n">rerun</span> <span class="o">--</span><span class="n">fastq</span><span class="o">-</span><span class="n">files</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">fastq</span> <span class="n">case</span><span class="o">.</span><span class="n">fastq</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">default_1</span>: create a index for reference genome
INFO: Step <span class="ansi-green-fg">default_1</span> (index=0) is <span class="ansi-green-fg">ignored</span> due to saved signature
INFO: Running <span class="ansi-green-fg">default_2</span>: align the reads to the reference genome
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating aligned/control.out.tab from ctrl.fastq
Generating aligned/mutated.out.tab from case.fastq
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">default_3</span>: compare expression values
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating myfigure.pdf
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Workflow default (ID=1863e0d7b1f26e5c) is executed successfully.
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An added benefit of specifying input and output of steps is it allows you to create an archive of your project with all input, output, and intermediate files. This can be achived using command</p>
<div class="highlight"><pre><span></span>% sos pack -o myanalysis.sar
</pre></div>
<p>if only one workflow has been executed under the current directory. The output is a compressed archive with extension <code>.sar</code> and can be examined and unpacked using command <code>sos unpack</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Use-make-rule-to-define-resource-providing-steps">Use make-rule to define resource-providing steps<a class="anchor-link" href="#Use-make-rule-to-define-resource-providing-steps">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Instead of using runtime signature to avoid re-running the first step, we can also make step 1 an optional step that will be executed only necessary. That is to say, we can define this step as an <code>auxiliary step</code> that will only be called when the file it <strong>provides</strong> does not exist.</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_sos">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="ch">#!/usr/bin/env sos-runner</span>
<span class="c1">#fileformat=SOS1.0</span>

<span class="c1"># This script aligns raw reads of a control and a mutated sample</span>
<span class="c1"># to the reference genome and compare the expression values</span>
<span class="c1"># of the samples at genes A, B and C.</span>

<span class="c1"># Two input files in .fastq formats. The first one for control sample</span>
<span class="c1"># and the second one for mutated sample.</span>
<span class="kn">parameter:</span> <span class="n">fastq_files</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;control.fastq&#39;</span><span class="p">,</span> <span class="s1">&#39;mutated.fastq&#39;</span><span class="p">]</span>

<span class="p">[</span><span class="n">build_index</span><span class="p">:</span> <span class="kp">provides</span><span class="o">=</span><span class="s1">&#39;STAR_index/chrName.txt&#39;</span><span class="p">]</span>
<span class="c1"># create a index for reference genome</span>
<span class="kn">run:</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">runMode</span> <span class="n">genomeGenerate</span> <span class="o">--</span><span class="n">genomeFastaFile</span> <span class="n">human38</span><span class="o">.</span><span class="n">fastq</span> \
        <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span>

<span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># align the reads to the reference genome</span>
<span class="kn">input:</span>    <span class="n">fastq_files</span>
<span class="kn">depends:</span>  <span class="s1">&#39;STAR_index/chrName.txt&#39;</span>
<span class="kn">output:</span>   <span class="p">[</span><span class="s1">&#39;aligned/control.out.tab&#39;</span><span class="p">,</span> <span class="s1">&#39;aligned/mutated.out.tab&#39;</span><span class="p">]</span>
<span class="kn">run:</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
        <span class="o">--</span><span class="n">readFilesIn</span> <span class="err">$</span><span class="p">{</span><span class="nb">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
        <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="n">control</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
        <span class="o">--</span><span class="n">readFilesIn</span> <span class="err">$</span><span class="p">{</span><span class="nb">input</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
        <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="n">mutated</span>

<span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="c1"># compare expression values</span>
<span class="kn">output:</span> <span class="s1">&#39;myfigure.pdf&#39;</span>
<span class="kn">R:</span>
    <span class="n">control</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;${input[0]}&#39;</span><span class="p">)</span>
    <span class="n">mutated</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;${input[1]}&#39;</span><span class="p">)</span>
    <span class="c1"># normalize, compare, output etc, ignored.</span>
    <span class="n">pdf</span><span class="p">(</span><span class="s1">&#39;${output}&#39;</span><span class="p">)</span>
    <span class="c1"># plot results</span>
    <span class="n">dev</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Adding step build_index with output STAR_index/chrName.txt
INFO: Running <span class="ansi-green-fg">build_index</span>: create a index for reference genome
INFO: Step <span class="ansi-green-fg">build_index</span> (index=0) is <span class="ansi-green-fg">ignored</span> due to saved signature
INFO: Running <span class="ansi-green-fg">default_1</span>: align the reads to the reference genome
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating aligned/control.out.tab from control.fastq
Generating aligned/mutated.out.tab from mutated.fastq
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">default_2</span>: compare expression values
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating myfigure.pdf
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Workflow default (ID=1c3c60b5b3a1bf3a) is executed successfully.
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The new script consists of two steps, and an auxiliary step <code>build_index</code> that will only be executed when <code>STAR_index/chrName.txt</code> is not available. A slight difference between this version and the previous one is that while the previous version will always execute the first step, this version will not execute it if <code>STAR_index/chrName.txt</code> has been generated before in any way, perhaps not by SoS.</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_sos">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="o">%</span><span class="n">rerun</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Adding step build_index with output STAR_index/chrName.txt
INFO: Running <span class="ansi-green-fg">build_index</span>: create a index for reference genome
INFO: Step <span class="ansi-green-fg">build_index</span> (index=0) is <span class="ansi-green-fg">ignored</span> due to saved signature
INFO: Running <span class="ansi-green-fg">default_1</span>: align the reads to the reference genome
INFO: Step <span class="ansi-green-fg">default_1</span> (index=0) is <span class="ansi-green-fg">ignored</span> due to saved signature
INFO: Running <span class="ansi-green-fg">default_2</span>: compare expression values
INFO: Step <span class="ansi-green-fg">default_2</span> (index=0) is <span class="ansi-green-fg">ignored</span> due to saved signature
INFO: Workflow default (ID=1c3c60b5b3a1bf3a) is executed successfully.
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Execute-long-running-jobs-externally">Execute long-running jobs externally<a class="anchor-link" href="#Execute-long-running-jobs-externally">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first step will takes a long time to execute. Instead of executing them by SoS, you might want to submit the commands to a job-queue and be executed and monitored externally. This is especially useful when you need to execute multiple SoS workflows on a cluster-based system. Without going through the details on how to set up your job-queue (see another tutorial for details), it is almost trivial to modify your script to define part of a <strong>step process</strong> to a <strong>task</strong>:</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_sos">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="ch">#!/usr/bin/env sos-runner</span>
<span class="c1">#fileformat=SOS1.0</span>

<span class="c1"># This script aligns raw reads of a control and a mutated sample</span>
<span class="c1"># to the reference genome and compare the expression values</span>
<span class="c1"># of the samples at genes A, B and C.</span>

<span class="c1"># Two input files in .fastq formats. The first one for control sample</span>
<span class="c1"># and the second one for mutated sample.</span>
<span class="kn">parameter:</span> <span class="n">fastq_files</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;control.fastq&#39;</span><span class="p">,</span> <span class="s1">&#39;mutated.fastq&#39;</span><span class="p">]</span>

<span class="p">[</span><span class="n">build_index</span><span class="p">:</span> <span class="kp">provides</span><span class="o">=</span><span class="s1">&#39;STAR_index/chrName.txt&#39;</span><span class="p">]</span>
<span class="c1"># create a index for reference genome</span>
<span class="kn">run:</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">runMode</span> <span class="n">genomeGenerate</span> <span class="o">--</span><span class="n">genomeFastaFile</span> <span class="n">human38</span><span class="o">.</span><span class="n">fastq</span> \
        <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span>

<span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># align the reads to the reference genome</span>
<span class="kn">input:</span>    <span class="n">fastq_files</span>
<span class="kn">depends:</span>  <span class="s1">&#39;STAR_index/chrName.txt&#39;</span>
<span class="kn">output:</span>   <span class="p">[</span><span class="s1">&#39;aligned/control.out.tab&#39;</span><span class="p">,</span> <span class="s1">&#39;aligned/mutated.out.tab&#39;</span><span class="p">]</span>
<span class="kn">task:</span>
<span class="kn">run:</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
        <span class="o">--</span><span class="n">readFilesIn</span> <span class="err">$</span><span class="p">{</span><span class="nb">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
        <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="n">control</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
        <span class="o">--</span><span class="n">readFilesIn</span> <span class="err">$</span><span class="p">{</span><span class="nb">input</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
        <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="n">mutated</span>

<span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="c1"># compare expression values</span>
<span class="kn">output:</span> <span class="s1">&#39;myfigure.pdf&#39;</span>
<span class="kn">R:</span>
    <span class="n">control</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;${input[0]}&#39;</span><span class="p">)</span>
    <span class="n">mutated</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;${input[1]}&#39;</span><span class="p">)</span>
    <span class="c1"># normalize, compare, output etc, ignored.</span>
    <span class="n">pdf</span><span class="p">(</span><span class="s1">&#39;${output}&#39;</span><span class="p">)</span>
    <span class="c1"># plot results</span>
    <span class="n">dev</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Adding step build_index with output STAR_index/chrName.txt
INFO: Running <span class="ansi-green-fg">build_index</span>: create a index for reference genome
INFO: Step <span class="ansi-green-fg">build_index</span> (index=0) is <span class="ansi-green-fg">ignored</span> due to saved signature
INFO: Running <span class="ansi-green-fg">default_1</span>: align the reads to the reference genome
INFO: Step <span class="ansi-green-fg">default_1</span> (index=0) is <span class="ansi-green-fg">ignored</span> due to saved signature
INFO: Running <span class="ansi-green-fg">default_2</span>: compare expression values
INFO: Step <span class="ansi-green-fg">default_2</span> (index=0) is <span class="ansi-green-fg">ignored</span> due to saved signature
INFO: Workflow default (ID=a1fe06faae4de480) is executed successfully.
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see, the only difference is the insertion of <code>task:</code> directive before <code>run</code>. Now, when you execute the command, the <code>STAR</code> commands will be executed externally and you can monitor the status of the jobs using your web browser. If no job-queue is set up, the command will be executed in a separate process.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Execute-steps-in-parallel">Execute steps in parallel<a class="anchor-link" href="#Execute-steps-in-parallel">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although the two steps of this example have to be executed sequentially, the first step runs the <code>STAR</code> command twice on two input files, and can be executed in parallel. You can tell this to SoS by modifying the script as follows</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_sos">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="ch">#!/usr/bin/env sos-runner</span>
<span class="c1">#fileformat=SOS1.0</span>

<span class="c1"># This script aligns raw reads of a control and a mutated sample</span>
<span class="c1"># to the reference genome and compare the expression values</span>
<span class="c1"># of the samples at genes A, B and C.</span>

<span class="c1"># Two input files in .fastq formats. The first one for control sample</span>
<span class="c1"># and the second one for mutated sample.</span>
<span class="kn">parameter:</span> <span class="n">fastq_files</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;control.fastq&#39;</span><span class="p">,</span> <span class="s1">&#39;mutated.fastq&#39;</span><span class="p">]</span>

<span class="p">[</span><span class="n">build_index</span><span class="p">:</span> <span class="kp">provides</span><span class="o">=</span><span class="s1">&#39;STAR_index/chrName.txt&#39;</span><span class="p">]</span>
<span class="c1"># create a index for reference genome</span>
<span class="kn">run:</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">runMode</span> <span class="n">genomeGenerate</span> <span class="o">--</span><span class="n">genomeFastaFile</span> <span class="n">human38</span><span class="o">.</span><span class="n">fastq</span> \
        <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span>

<span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># align the reads to the reference genome</span>
<span class="n">sample_type</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;control&#39;</span><span class="p">,</span> <span class="s1">&#39;mutated&#39;</span><span class="p">]</span>
<span class="kn">input:</span>    <span class="n">fastq_files</span><span class="p">,</span> <span class="kp">group_by</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="kp">paired_with</span><span class="o">=</span><span class="s1">&#39;sample_type&#39;</span>
<span class="kn">depends:</span>  <span class="s1">&#39;STAR_index/chrName.txt&#39;</span>
<span class="kn">output:</span>   <span class="s2">&quot;aligned/${_sample_type}.out.tab&quot;</span>

<span class="kn">task:</span>     <span class="kp">concurrent</span><span class="o">=</span><span class="bp">True</span>
<span class="kn">run:</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
        <span class="o">--</span><span class="n">readFilesIn</span> <span class="err">$</span><span class="p">{</span><span class="n">_input</span><span class="err">!</span><span class="n">q</span><span class="p">}</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
        <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">_sample_type</span><span class="p">}</span>

<span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="c1"># compare expression values</span>
<span class="kn">output:</span> <span class="s1">&#39;myfigure.pdf&#39;</span>
<span class="kn">R:</span>
    <span class="n">control</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;${input[0]}&#39;</span><span class="p">)</span>
    <span class="n">mutated</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;${input[1]}&#39;</span><span class="p">)</span>
    <span class="c1"># normalize, compare, output etc, ignored.</span>
    <span class="n">pdf</span><span class="p">(</span><span class="s1">&#39;${output}&#39;</span><span class="p">)</span>
    <span class="c1"># plot results</span>
    <span class="n">dev</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Adding step build_index with output STAR_index/chrName.txt
INFO: Running <span class="ansi-green-fg">build_index</span>: create a index for reference genome
INFO: Step <span class="ansi-green-fg">build_index</span> (index=0) is <span class="ansi-green-fg">ignored</span> due to saved signature
INFO: Running <span class="ansi-green-fg">default_1</span>: align the reads to the reference genome
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating aligned/control.out.tab from control.fastq
Generating aligned/mutated.out.tab from mutated.fastq
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">default_2</span>: compare expression values
INFO: Step <span class="ansi-green-fg">default_2</span> (index=0) is <span class="ansi-green-fg">ignored</span> due to saved signature
INFO: Workflow default (ID=95df7eeeafcdaa5c) is executed successfully.
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we</p>
<ol>
<li>Use option <code>group_by='single'</code> to pass input one by one to action. The action will be executed twice with <code>_input</code> set to the first and second input file respectively.</li>
<li>Define a variable <code>sample_type</code> and pair it with input files (option <code>paired_with</code>). This will generate a variable <code>_sample_type</code> for each input file so <code>_sample_type</code> will be <code>control</code> for the first input file, and <code>mutated</code> for the second.</li>
<li>Use <code>${_input}</code> and <code>${_sample_type}</code> to define partial <code>output</code>.</li>
<li>Use <code>${_input!q}</code> instead of <code>${_input}</code> in the script. This is a small trick to shell-quote filenames so that filenames with spaces and other special characters can be properly quoted in shell commands.</li>
</ol>
<p>Now, if you execute the script with option <code>-j 2</code> (2 concurrent processes),</p>
<div class="highlight"><pre><span></span>sos run myanalysis.sos --input control1.fastq control2.fastq -j 2
</pre></div>
<p>the second step submit two jobs to job-queue, or execute them in two separate processes if a job-queue is not setup.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generating-a-report">Generating a report<a class="anchor-link" href="#Generating-a-report">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In addition to functions such as <code>run</code> and <code>R</code> that execute scripts in different languages, SoS provides a number of other functions (called actions) that can be used to, for example, generate reports using command <code>pandoc</code> or <code>Rmarkdown</code>. For example, by adding a step with a <code>pandoc</code> action, you can compose a script in Markdown format and generate a nice-looking report in HTML format.</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_sos">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="ch">#!/usr/bin/env sos-runner</span>
<span class="c1">#fileformat=SOS1.0</span>

<span class="c1"># This script aligns raw reads of a control and a mutated sample</span>
<span class="c1"># to the reference genome and compare the expression values</span>
<span class="c1"># of the samples at genes A, B and C.</span>

<span class="c1"># Two input files in .fastq formats. The first one for control sample</span>
<span class="c1"># and the second one for mutated sample.</span>
<span class="kn">parameter:</span> <span class="n">fastq_files</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;control.fastq&#39;</span><span class="p">,</span> <span class="s1">&#39;mutated.fastq&#39;</span><span class="p">]</span>

<span class="p">[</span><span class="n">build_index</span><span class="p">:</span> <span class="kp">provides</span><span class="o">=</span><span class="s1">&#39;STAR_index/chrName.txt&#39;</span><span class="p">]</span>
<span class="c1"># create a index for reference genome</span>
<span class="kn">run:</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">runMode</span> <span class="n">genomeGenerate</span> <span class="o">--</span><span class="n">genomeFastaFile</span> <span class="n">human38</span><span class="o">.</span><span class="n">fastq</span> \
        <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span>

<span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># align the reads to the reference genome</span>
<span class="n">sample_type</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;control&#39;</span><span class="p">,</span> <span class="s1">&#39;mutated&#39;</span><span class="p">]</span>
<span class="kn">input:</span>    <span class="n">fastq_files</span><span class="p">,</span> <span class="kp">group_by</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="kp">paired_with</span><span class="o">=</span><span class="s1">&#39;sample_type&#39;</span>
<span class="kn">depends:</span>  <span class="s1">&#39;STAR_index/chrName.txt&#39;</span>
<span class="kn">output:</span>   <span class="s2">&quot;aligned/${_sample_type}.out.tab&quot;</span>

<span class="kn">task:</span>     <span class="kp">concurrent</span><span class="o">=</span><span class="bp">True</span>
<span class="kn">run:</span>
    <span class="n">STAR</span> <span class="o">--</span><span class="n">genomeDir</span> <span class="n">STAR_index</span> <span class="o">--</span><span class="n">outSAMtype</span> <span class="n">BAM</span> <span class="n">SortedByCoordinate</span> \
        <span class="o">--</span><span class="n">readFilesIn</span> <span class="err">$</span><span class="p">{</span><span class="n">_input</span><span class="err">!</span><span class="n">q</span><span class="p">}</span> <span class="o">--</span><span class="n">quantMode</span> <span class="n">GeneCounts</span> \
        <span class="o">--</span><span class="n">outFileNamePrefix</span> <span class="n">aligned</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">_sample_type</span><span class="p">}</span>

<span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="c1"># compare expression values</span>
<span class="kn">output:</span> <span class="s1">&#39;myfigure.pdf&#39;</span>
<span class="kn">R:</span>
    <span class="n">control</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;${input[0]}&#39;</span><span class="p">)</span>
    <span class="n">mutated</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;${input[1]}&#39;</span><span class="p">)</span>
    <span class="c1"># normalize, compare, output etc, ignored.</span>
    <span class="n">pdf</span><span class="p">(</span><span class="s1">&#39;${output}&#39;</span><span class="p">)</span>
    <span class="c1"># plot results</span>
    <span class="n">dev</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>

<span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="kn">pandoc:</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;report.html&#39;</span>
    <span class="c1">## An analysis of two RNA Seq samples</span>
    
    <span class="c1">## comparison of expressions</span>
    <span class="err">!</span><span class="p">[</span><span class="n">comparison</span><span class="p">](</span><span class="err">$</span><span class="p">{</span><span class="nb">input</span><span class="p">})</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Adding step build_index with output STAR_index/chrName.txt
INFO: Running <span class="ansi-green-fg">build_index</span>: create a index for reference genome
INFO: Step <span class="ansi-green-fg">build_index</span> (index=0) is <span class="ansi-green-fg">ignored</span> due to saved signature
INFO: Running <span class="ansi-green-fg">default_1</span>: align the reads to the reference genome
INFO: Step <span class="ansi-green-fg">default_1</span> (index=0) is <span class="ansi-green-fg">ignored</span> due to saved signature
INFO: Step <span class="ansi-green-fg">default_1</span> (index=1) is <span class="ansi-green-fg">ignored</span> due to saved signature
INFO: Running <span class="ansi-green-fg">default_2</span>: compare expression values
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Generating myfigure.pdf
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Running <span class="ansi-green-fg">default_3</span>: 
INFO: Report saved to report.html
INFO: Workflow default (ID=054b87f1101afa31) is executed successfully.
</pre>
</div>
</div>

</div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Please refer to <a href="Generating_Reports.html">the report generation tutorial</a> for details.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have showed you multiple versions of the same SoS script, each using more features of SoS. This actually demonstrates one of the advantages of the SoS system, namely you can start using SoS in minutes without knowing any of its advanced features, and gradually improve your script if needed.</p>

</div>
</div>
</div>
    </div>
  </div>
</body>

 


</html>
